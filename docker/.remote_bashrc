# ğŸš€ è¿œç¨‹Dockerå¼€å‘ç¯å¢ƒä¸“ç”¨ .bashrc
# ä½œè€…: Zhang-Jingdian
# åˆ›å»ºæ—¶é—´: 2025å¹´7æœˆ15æ—¥

# ================================================================================================
# åŸºç¡€è®¾ç½®
# ================================================================================================
export TERM=xterm-256color
export EDITOR=nano
export LANG=C.UTF-8
export PYTHONIOENCODING=utf-8

# å†å²å‘½ä»¤è®¾ç½®
export HISTSIZE=10000
export HISTFILESIZE=20000
export HISTCONTROL=ignoredups:erasedups
shopt -s histappend

# ================================================================================================
# æ¼‚äº®çš„æç¤ºç¬¦è®¾ç½®
# ================================================================================================
# å‚è€ƒ: https://www.thenetnerd.uk/2022/11/23/fancy-linux-command-prompt/
# å¤šè¡Œæç¤ºç¬¦ï¼ŒåŒ…å«çŠ¶æ€æŒ‡ç¤ºã€ç”¨æˆ·ã€ä¸»æœºã€è·¯å¾„

# é¢œè‰²å®šä¹‰
RED='\[\033[0;31m\]'
GREEN='\[\033[0;32m\]'
YELLOW='\[\033[0;33m\]'
BLUE='\[\033[0;34m\]'
PURPLE='\[\033[0;35m\]'
CYAN='\[\033[0;36m\]'
WHITE='\[\033[0;37m\]'
GRAY='\[\033[0;90m\]'
BOLD_RED='\[\033[1;31m\]'
BOLD_GREEN='\[\033[1;32m\]'
BOLD_YELLOW='\[\033[1;33m\]'
BOLD_BLUE='\[\033[1;34m\]'
BOLD_PURPLE='\[\033[1;35m\]'
BOLD_CYAN='\[\033[1;36m\]'
BOLD_WHITE='\[\033[1;37m\]'
NC='\[\033[0m\]' # No Color

# å¤šè¡Œæç¤ºç¬¦ï¼Œå¸¦æœ‰å‘½ä»¤æ‰§è¡ŒçŠ¶æ€æŒ‡ç¤º
export PS1="${GRAY}â”Œâ”€\$(if [[ \$? == 0 ]]; then echo \"[${BOLD_GREEN}âœ“${GRAY}]\"; else echo \"[${BOLD_RED}âœ—${GRAY}]\"; fi)â”€[${BOLD_CYAN}ğŸ³ remote-dev${GRAY}]â”€[${BOLD_YELLOW}\u${GRAY}]â”€[${BOLD_BLUE}\w${GRAY}]\nâ””â”€${BOLD_GREEN}\$ ${NC}"

# ç®€å•ç‰ˆæœ¬çš„æç¤ºç¬¦ï¼ˆå¦‚æœä¸Šé¢çš„å¤ªå¤æ‚å¯ä»¥ç”¨è¿™ä¸ªï¼‰
# export PS1="${BOLD_CYAN}ğŸ³ remote-dev${NC}:${BOLD_BLUE}\w${NC}\$ "

# ================================================================================================
# æœ‰ç”¨çš„åˆ«å
# ================================================================================================
alias ll='ls -alF --color=auto'
alias la='ls -A --color=auto'
alias l='ls -CF --color=auto'
alias ls='ls --color=auto'
alias grep='grep --color=auto'
alias fgrep='fgrep --color=auto'
alias egrep='egrep --color=auto'

# ç›®å½•å¯¼èˆª
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias .....='cd ../../../..'

# Pythonç›¸å…³
alias python='python3'
alias pip='pip3'
alias py='python3'

# å¸¸ç”¨æ“ä½œ
alias h='history'
alias c='clear'
alias e='nano'
alias tree='find . -type d -name ".*" -prune -o -print | sed -e "s;[^/]*/;|____;g;s;____|; |;g"'

# Gitç›¸å…³ï¼ˆå¦‚æœå®‰è£…äº†gitï¼‰
alias gs='git status'
alias ga='git add'
alias gc='git commit'
alias gp='git push'
alias gl='git log --oneline'

# Dockerç›¸å…³
alias dps='docker ps'
alias dpsa='docker ps -a'

# ================================================================================================
# è‡ªå®šä¹‰å‡½æ•°
# ================================================================================================

# å¿«é€ŸæŸ¥çœ‹æ–‡ä»¶å†…å®¹
function peek() {
    if [ -f "$1" ]; then
        echo -e "${BOLD_CYAN}ğŸ“„ æ–‡ä»¶å†…å®¹: $1${NC}"
        echo -e "${GRAY}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
        head -20 "$1"
        if [ $(wc -l < "$1") -gt 20 ]; then
            echo -e "${GRAY}... (æ›´å¤šå†…å®¹è¯·ä½¿ç”¨ cat æˆ– less æŸ¥çœ‹)${NC}"
        fi
        echo -e "${GRAY}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    else
        echo -e "${BOLD_RED}âŒ æ–‡ä»¶ä¸å­˜åœ¨: $1${NC}"
    fi
}

# å¿«é€Ÿåˆ›å»ºå¹¶è¿›å…¥ç›®å½•
function mkcd() {
    mkdir -p "$1" && cd "$1"
}

# æ˜¾ç¤ºå½“å‰ç›®å½•çš„æ–‡ä»¶æ ‘
function lstree() {
    find "${1:-.}" -type d -name ".*" -prune -o -print | head -50 | sed -e 's;[^/]*/;|____;g;s;____|; |;g'
}

# ================================================================================================
# æ¬¢è¿æ¶ˆæ¯
# ================================================================================================
function show_welcome() {
    echo -e "${BOLD_PURPLE}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${BOLD_CYAN}ğŸš€ æ¬¢è¿è¿›å…¥è¿œç¨‹Dockerå¼€å‘ç¯å¢ƒï¼${NC}"
    echo -e "${WHITE}ğŸ“ å·¥ä½œç›®å½•: ${BOLD_BLUE}$(pwd)${NC}"
    echo -e "${WHITE}ğŸ› ï¸  å¯ç”¨å·¥å…·: ${BOLD_GREEN}python3, pip, git, nano, curl${NC}"
    echo -e "${WHITE}ğŸ’¡ æç¤º: ä½ çš„æœ¬åœ°ä»£ç å·²åŒæ­¥åˆ°æ­¤å®¹å™¨ä¸­${NC}"
    echo -e "${WHITE}ğŸ“ å¯ç”¨åˆ«å: ${BOLD_YELLOW}ll, la, py, h, c, e, gs, ga, gc${NC}"
    echo -e "${WHITE}ğŸ¯ è‡ªå®šä¹‰å‡½æ•°: ${BOLD_YELLOW}peek <file>, mkcd <dir>, lstree${NC}"
    echo -e "${BOLD_PURPLE}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
}

# åªåœ¨äº¤äº’å¼shellä¸­æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
if [[ $- == *i* ]]; then
    show_welcome
fi

# ================================================================================================
# å…¶ä»–è®¾ç½®
# ================================================================================================

# å¯ç”¨é¢œè‰²æç¤º
force_color_prompt=yes

# ä½¿å‘½ä»¤è¡¥å…¨æ›´æ™ºèƒ½
bind "set completion-ignore-case on"
bind "set show-all-if-ambiguous on"
bind "set menu-complete-display-prefix on"

# cdæ—¶è‡ªåŠ¨ls
function cd() {
    builtin cd "$@" && ls -la --color=auto
} 